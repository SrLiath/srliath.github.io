(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8285:(e,t,o)=>{Promise.resolve().then(o.bind(o,4883))},4883:(e,t,o)=>{"use strict";o.d(t,{default:()=>A});var i=o(5155),l=o(2115);function r(e){let{type:t,color:o}=e;if(!t||!o)return null;let l="".concat(o,"-").concat(t);return(0,i.jsx)("div",{className:"text-4xl ".concat("white"===o?"text-white":"text-black"),children:{"white-king":"♔","white-queen":"♕","white-rook":"♖","white-bishop":"♗","white-knight":"♘","white-pawn":"♙","black-king":"♚","black-queen":"♛","black-rook":"♜","black-bishop":"♝","black-knight":"♞","black-pawn":"♟"}[l]})}var c=o(2317),a=o(1027),s=o(3463),n=o(9795);function d(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return(0,n.QP)((0,s.$)(t))}let p=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=l.forwardRef((e,t)=>{let{className:o,variant:l,size:r,asChild:a=!1,...s}=e,n=a?c.DX:"button";return(0,i.jsx)(n,{className:d(p({variant:l,size:r,className:o})),ref:t,...s})});h.displayName="Button";var u=o(7410),f=o(2823),m=o(1556),g=o(7364),v=o(9053),w=o(8333),b=o(767);let x=w.bL;w.l9;let y=w.ZL;w.bm;let k=l.forwardRef((e,t)=>{let{className:o,...l}=e;return(0,i.jsx)(w.hJ,{ref:t,className:d("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",o),...l})});k.displayName=w.hJ.displayName;let j=l.forwardRef((e,t)=>{let{className:o,children:l,...r}=e;return(0,i.jsxs)(y,{children:[(0,i.jsx)(k,{}),(0,i.jsxs)(w.UC,{ref:t,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),...r,children:[l,(0,i.jsxs)(w.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,i.jsx)(b.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});j.displayName=w.UC.displayName;let N=l.forwardRef((e,t)=>{let{className:o,...l}=e;return(0,i.jsx)(w.hE,{ref:t,className:d("text-lg font-semibold leading-none tracking-tight",o),...l})});N.displayName=w.hE.displayName,l.forwardRef((e,t)=>{let{className:o,...l}=e;return(0,i.jsx)(w.VY,{ref:t,className:d("text-sm text-muted-foreground",o),...l})}).displayName=w.VY.displayName;var M=o(9558);let C=l.forwardRef((e,t)=>{let{className:o,...l}=e;return(0,i.jsx)(M.bL,{className:d("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",o),...l,ref:t,children:(0,i.jsx)(M.zi,{className:d("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});C.displayName=M.bL.displayName;var R=o(6195);let S=(0,a.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),V=l.forwardRef((e,t)=>{let{className:o,...l}=e;return(0,i.jsx)(R.b,{ref:t,className:d(S(),o),...l})});V.displayName=R.b.displayName;let q={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:100,null:0};function E(e){let{isOpen:t,onClose:o,onSelect:l,color:c}=e;return(0,i.jsx)(x,{open:t,onOpenChange:e=>!e&&o(),children:(0,i.jsxs)(j,{className:"sm:max-w-md bg-[#2f2f2f] border-[#444444] text-white",children:[(0,i.jsx)(N,{children:"Escolha uma pe\xe7a para promo\xe7\xe3o"}),(0,i.jsx)("div",{className:"flex justify-center gap-4 p-4",children:["queen","rook","bishop","knight"].map(e=>(0,i.jsx)("button",{className:"p-2 rounded-lg hover:bg-[#444444] transition-colors",onClick:()=>l(e),children:(0,i.jsx)("div",{className:"w-12 h-12 flex items-center justify-center",children:(0,i.jsx)(r,{type:e,color:c})})},e))})]})})}function A(){let[e,t]=(0,l.useState)([]),[o,c]=(0,l.useState)(null),[a,s]=(0,l.useState)("white"),[n,d]=(0,l.useState)(""),[p,w]=(0,l.useState)(!1),[b,x]=(0,l.useState)(!1),[y,k]=(0,l.useState)(!1),[j,N]=(0,l.useState)([]),[M,R]=(0,l.useState)(-1),[S,A]=(0,l.useState)(!1),[z,P]=(0,l.useState)(!1),[L,B]=(0,l.useState)(null),[O,_]=(0,l.useState)(null),[T,D]=(0,l.useState)([]),[F,W]=(0,l.useState)(!1),[X,Y]=(0,l.useState)(null),[H,J]=(0,l.useState)(null);(0,l.useEffect)(()=>{U()},[]),(0,l.useEffect)(()=>{if(b&&"black"===a&&!p&&!z&&!S){let e=setTimeout(()=>{ex()},500);return()=>clearTimeout(e)}},[b,a,p,z,S]);let U=()=>{let e=Array(8).fill(null).map((e,t)=>Array(8).fill(null).map((e,o)=>({piece:null,highlighted:!1,selected:!1,isValidMove:!1,position:{row:t,col:o}})));for(let t=0;t<8;t++)e[1][t].piece={type:"pawn",color:"black",hasMoved:!1},e[6][t].piece={type:"pawn",color:"white",hasMoved:!1};e[0][0].piece={type:"rook",color:"black",hasMoved:!1},e[0][7].piece={type:"rook",color:"black",hasMoved:!1},e[7][0].piece={type:"rook",color:"white",hasMoved:!1},e[7][7].piece={type:"rook",color:"white",hasMoved:!1},e[0][1].piece={type:"knight",color:"black"},e[0][6].piece={type:"knight",color:"black"},e[7][1].piece={type:"knight",color:"white"},e[7][6].piece={type:"knight",color:"white"},e[0][2].piece={type:"bishop",color:"black"},e[0][5].piece={type:"bishop",color:"black"},e[7][2].piece={type:"bishop",color:"white"},e[7][5].piece={type:"bishop",color:"white"},e[0][3].piece={type:"queen",color:"black"},e[7][3].piece={type:"queen",color:"white"},e[0][4].piece={type:"king",color:"black",hasMoved:!1},e[7][4].piece={type:"king",color:"white",hasMoved:!1},t(e),s("white"),d(""),w(!1),N([]),R(-1),A(!1)},Q=(i,l)=>{var r,s;if(p||S||b&&"black"===a)return;let n=[...e.map(e=>[...e])];if(o){if(o.row===i&&o.col===l)$(n),c(null);else if(n[i][l].isValidMove){let e=n[o.row][o.col].piece;(null==e?void 0:e.type)==="pawn"&&(0===i||7===i)?(B({fromRow:o.row,fromCol:o.col,toRow:i,toCol:l}),P(!0)):(ea(o.row,o.col,i,l),$(n),c(null))}else n[i][l].piece&&(null===(s=n[i][l].piece)||void 0===s?void 0:s.color)===a?($(n),n[i][l].selected=!0,c({row:i,col:l}),G(n,i,l)):($(n),c(null))}else n[i][l].piece&&(null===(r=n[i][l].piece)||void 0===r?void 0:r.color)===a&&(n[i][l].selected=!0,c({row:i,col:l}),G(n,i,l));t(n)},I=(e,t,o)=>{2===e.button&&(e.preventDefault(),W(!0),Y({row:t,col:o}))},K=(e,t,o)=>{F&&X&&J({row:t,col:o})},Z=(e,t,o)=>{if(2===e.button&&F&&X){if(e.preventDefault(),X.row!==t||X.col!==o){let e=T.findIndex(e=>e.from.row===X.row&&e.from.col===X.col&&e.to.row===t&&e.to.col===o),i=X.row!==t&&X.col!==o;-1!==e?D(T.filter((t,o)=>o!==e)):D([...T,{from:X,to:{row:t,col:o},color:"white"===a?"#5882d8":"#d85858",isLShaped:i}])}W(!1),Y(null),J(null)}},$=e=>{for(let t=0;t<8;t++)for(let o=0;o<8;o++)e[t][o].highlighted=!1,e[t][o].selected=!1,e[t][o].isValidMove=!1},G=(e,t,o)=>{let i=e[t][o].piece;if(i)switch(i.type){case"pawn":ee(e,t,o,i.color);break;case"rook":et(e,t,o,i.color);break;case"knight":eo(e,t,o,i.color);break;case"bishop":ei(e,t,o,i.color);break;case"queen":et(e,t,o,i.color),ei(e,t,o,i.color);break;case"king":el(e,t,o,i.color)}},ee=(e,t,o,i)=>{let l="white"===i?-1:1;!er(t+l,o)||e[t+l][o].piece||(e[t+l][o].isValidMove=!0,e[t+l][o].highlighted=!0,t!==("white"===i?6:1)||e[t+2*l][o].piece||(e[t+2*l][o].isValidMove=!0,e[t+2*l][o].highlighted=!0)),[{r:l,c:-1},{r:l,c:1}].forEach(l=>{var r,c,a;let s=t+l.r,n=o+l.c;er(s,n)&&e[s][n].piece&&(null===(r=e[s][n].piece)||void 0===r?void 0:r.color)!==i&&(e[s][n].isValidMove=!0,e[s][n].highlighted=!0),er(s,n)&&!e[s][n].piece&&O&&O.row===t&&O.col===n&&(null===(c=e[t][n].piece)||void 0===c?void 0:c.type)==="pawn"&&(null===(a=e[t][n].piece)||void 0===a?void 0:a.color)!==i&&(e[s][n].isValidMove=!0,e[s][n].highlighted=!0)})},et=(e,t,o,i)=>{[{r:-1,c:0},{r:1,c:0},{r:0,c:-1},{r:0,c:1}].forEach(l=>{let r=t+l.r,c=o+l.c;for(;er(r,c);){if(e[r][c].piece){var a;(null===(a=e[r][c].piece)||void 0===a?void 0:a.color)!==i&&(e[r][c].isValidMove=!0,e[r][c].highlighted=!0);break}e[r][c].isValidMove=!0,e[r][c].highlighted=!0,r+=l.r,c+=l.c}})},eo=(e,t,o,i)=>{[{r:-2,c:-1},{r:-2,c:1},{r:-1,c:-2},{r:-1,c:2},{r:1,c:-2},{r:1,c:2},{r:2,c:-1},{r:2,c:1}].forEach(l=>{var r;let c=t+l.r,a=o+l.c;er(c,a)&&(!e[c][a].piece||(null===(r=e[c][a].piece)||void 0===r?void 0:r.color)!==i)&&(e[c][a].isValidMove=!0,e[c][a].highlighted=!0)})},ei=(e,t,o,i)=>{[{r:-1,c:-1},{r:-1,c:1},{r:1,c:-1},{r:1,c:1}].forEach(l=>{let r=t+l.r,c=o+l.c;for(;er(r,c);){if(e[r][c].piece){var a;(null===(a=e[r][c].piece)||void 0===a?void 0:a.color)!==i&&(e[r][c].isValidMove=!0,e[r][c].highlighted=!0);break}e[r][c].isValidMove=!0,e[r][c].highlighted=!0,r+=l.r,c+=l.c}})},el=(e,t,o,i)=>{var l,r,c,a,s;[{r:-1,c:-1},{r:-1,c:0},{r:-1,c:1},{r:0,c:-1},{r:0,c:1},{r:1,c:-1},{r:1,c:0},{r:1,c:1}].forEach(l=>{var r;let c=t+l.r,a=o+l.c;er(c,a)&&(!e[c][a].piece||(null===(r=e[c][a].piece)||void 0===r?void 0:r.color)!==i)&&(e[c][a].isValidMove=!0,e[c][a].highlighted=!0)}),(null===(l=e[t][o].piece)||void 0===l?void 0:l.hasMoved)||((null===(r=e[t][7].piece)||void 0===r?void 0:r.type)!=="rook"||(null===(c=e[t][7].piece)||void 0===c?void 0:c.hasMoved)||e[t][5].piece||e[t][6].piece||(e[t][6].isValidMove=!0,e[t][6].highlighted=!0),(null===(a=e[t][0].piece)||void 0===a?void 0:a.type)!=="rook"||(null===(s=e[t][0].piece)||void 0===s?void 0:s.hasMoved)||e[t][1].piece||e[t][2].piece||e[t][3].piece||(e[t][2].isValidMove=!0,e[t][2].highlighted=!0))},er=(e,t)=>e>=0&&e<8&&t>=0&&t<8,ec=function(e,t,o,i,l,r,c,a){let s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],n=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=arguments.length>10?arguments[10]:void 0;if(s)return i>t?"O-O":"O-O-O";let p={pawn:"",rook:"R",knight:"N",bishop:"B",queen:"Q",king:"K",null:""},h=String.fromCharCode(97+t),u=String.fromCharCode(97+i),f="";return"pawn"!==l.type&&(f+=p[l.type]),"pawn"===l.type&&r&&(f+=h),(r||n)&&(f+="x"),f+=u+(8-o),d&&(f+="="+p[d]),a?f+="#":c&&(f+="+"),f},ea=(o,i,l,r)=>{let c=[...e.map(e=>[...e])],n=c[o][i].piece,d=c[l][r].piece;if(!n)return;let p="king"===n.type&&2===Math.abs(i-r),h="pawn"===n.type&&1===Math.abs(i-r)&&!c[l][r].piece&&O&&O.row===o&&O.col===r;_(null),p&&(6===r?(c[o][5].piece=c[o][7].piece,c[o][7].piece=null,c[o][5].piece&&(c[o][5].piece.hasMoved=!0)):2===r&&(c[o][3].piece=c[o][0].piece,c[o][0].piece=null,c[o][3].piece&&(c[o][3].piece.hasMoved=!0)));let u=null;h&&(u=c[o][r].piece,c[o][r].piece=null),"pawn"===n.type&&2===Math.abs(o-l)&&_({row:l,col:r}),c[l][r].piece={...n,hasMoved:!0},c[o][i].piece=null;let f="white"===a?"black":"white",m=ed(c,f),g=m&&!eh(c,f),v=ec(o,i,l,r,n,d||u,m,g,p,h),w={from:{row:o,col:i},to:{row:l,col:r},piece:{...n},capturedPiece:d?{...d}:u?{...u}:null,notation:v,isCheck:m,isCheckmate:g,isEnPassant:h,isCastling:p},b=[...j.slice(0,M+1),w];N(b),R(b.length-1),A(!1),s(f),t(c),ek(),ey(c,f)},es=(e,t)=>{for(let o=0;o<8;o++)for(let i=0;i<8;i++){let l=e[o][i].piece;if(l&&"king"===l.type&&l.color===t)return{row:o,col:i}}return null},en=(e,t,o,i)=>{let l="white"===i?-1:1;for(let r of[{r:-l,c:-1},{r:-l,c:1}]){let l=t+r.r,c=o+r.c;if(er(l,c)){let t=e[l][c].piece;if(t&&"pawn"===t.type&&t.color===i)return!0}}for(let l of[{r:-2,c:-1},{r:-2,c:1},{r:-1,c:-2},{r:-1,c:2},{r:1,c:-2},{r:1,c:2},{r:2,c:-1},{r:2,c:1}]){let r=t+l.r,c=o+l.c;if(er(r,c)){let t=e[r][c].piece;if(t&&"knight"===t.type&&t.color===i)return!0}}for(let l of[{r:-1,c:0},{r:1,c:0},{r:0,c:-1},{r:0,c:1}]){let r=t+l.r,c=o+l.c;for(;er(r,c);){let t=e[r][c].piece;if(t){if(t.color===i&&("rook"===t.type||"queen"===t.type))return!0;break}r+=l.r,c+=l.c}}for(let l of[{r:-1,c:-1},{r:-1,c:1},{r:1,c:-1},{r:1,c:1}]){let r=t+l.r,c=o+l.c;for(;er(r,c);){let t=e[r][c].piece;if(t){if(t.color===i&&("bishop"===t.type||"queen"===t.type))return!0;break}r+=l.r,c+=l.c}}for(let l of[{r:-1,c:-1},{r:-1,c:0},{r:-1,c:1},{r:0,c:-1},{r:0,c:1},{r:1,c:-1},{r:1,c:0},{r:1,c:1}]){let r=t+l.r,c=o+l.c;if(er(r,c)){let t=e[r][c].piece;if(t&&"king"===t.type&&t.color===i)return!0}}return!1},ed=(e,t)=>{let o=es(e,t);return!!o&&en(e,o.row,o.col,"white"===t?"black":"white")},ep=(e,t,o,i,l,r)=>{let c=e.map(e=>e.map(e=>({...e,piece:e.piece?{...e.piece}:null}))),a=c[t][o].piece;return!!a&&(c[i][l].piece=a,c[t][o].piece=null,ed(c,r))},eh=(e,t)=>{for(let o=0;o<8;o++)for(let i=0;i<8;i++){let l=e[o][i].piece;if(l&&l.color===t)for(let r=0;r<8;r++)for(let c=0;c<8;c++){if(o===r&&i===c)continue;let a=!1;switch(l.type){case"pawn":a=ef(e,o,i,r,c);break;case"rook":a=em(e,o,i,r,c);break;case"knight":a=eg(e,o,i,r,c);break;case"bishop":a=ev(e,o,i,r,c);break;case"queen":a=em(e,o,i,r,c)||ev(e,o,i,r,c);break;case"king":a=ew(e,o,i,r,c)}if(a&&!ep(e,o,i,r,c,t))return!0}}return!1},eu=(e,t)=>{let o=[];for(let i=0;i<8;i++)for(let l=0;l<8;l++){let r=e[i][l].piece;if(r&&r.color===t)for(let c=0;c<8;c++)for(let a=0;a<8;a++){if(i===c&&l===a)continue;let s=!1;switch(r.type){case"pawn":s=ef(e,i,l,c,a);break;case"rook":s=em(e,i,l,c,a);break;case"knight":s=eg(e,i,l,c,a);break;case"bishop":s=ev(e,i,l,c,a);break;case"queen":s=em(e,i,l,c,a)||ev(e,i,l,c,a);break;case"king":s=ew(e,i,l,c,a)}s&&!ep(e,i,l,c,a,t)&&o.push({fromRow:i,fromCol:l,toRow:c,toCol:a,piece:r,capturedPiece:e[c][a].piece})}}return o},ef=(e,t,o,i,l)=>{var r,c,a;let s=e[t][o].piece;if(!s||"pawn"!==s.type)return!1;let n="white"===s.color?-1:1,d="white"===s.color?6:1;return o===l&&i===t+n&&!e[i][l].piece||o===l&&t===d&&i===t+2*n&&!e[t+n][o].piece&&!e[i][l].piece||1===Math.abs(o-l)&&i===t+n&&!!e[i][l].piece&&(null===(r=e[i][l].piece)||void 0===r?void 0:r.color)!==s.color||1===Math.abs(o-l)&&i===t+n&&!e[i][l].piece&&!!O&&O.row===t&&O.col===l&&(null===(c=e[t][l].piece)||void 0===c?void 0:c.type)==="pawn"&&(null===(a=e[t][l].piece)||void 0===a?void 0:a.color)!==s.color},em=(e,t,o,i,l)=>{var r;let c=e[t][o].piece;if(!c||t!==i&&o!==l)return!1;let a=t===i?0:i>t?1:-1,s=o===l?0:l>o?1:-1,n=t+a,d=o+s;for(;n!==i||d!==l;){if(e[n][d].piece)return!1;n+=a,d+=s}return!e[i][l].piece||(null===(r=e[i][l].piece)||void 0===r?void 0:r.color)!==c.color},eg=(e,t,o,i,l)=>{var r;let c=e[t][o].piece;if(!c)return!1;let a=Math.abs(t-i),s=Math.abs(o-l);return(2===a&&1===s||1===a&&2===s)&&(!e[i][l].piece||(null===(r=e[i][l].piece)||void 0===r?void 0:r.color)!==c.color)},ev=(e,t,o,i,l)=>{var r;let c=e[t][o].piece;if(!c||Math.abs(t-i)!==Math.abs(o-l))return!1;let a=i>t?1:-1,s=l>o?1:-1,n=t+a,d=o+s;for(;n!==i&&d!==l;){if(e[n][d].piece)return!1;n+=a,d+=s}return!e[i][l].piece||(null===(r=e[i][l].piece)||void 0===r?void 0:r.color)!==c.color},ew=(e,t,o,i,l)=>{var r,c,a,s,n;let d=e[t][o].piece;if(!d)return!1;let p=Math.abs(t-i),h=Math.abs(o-l);return p>1||h>1?!d.hasMoved&&0===p&&2===h&&(l>o?(null===(c=e[t][7].piece)||void 0===c?void 0:c.type)==="rook"&&!(null===(a=e[t][7].piece)||void 0===a?void 0:a.hasMoved)&&!e[t][5].piece&&!e[t][6].piece:(null===(s=e[t][0].piece)||void 0===s?void 0:s.type)==="rook"&&!(null===(n=e[t][0].piece)||void 0===n?void 0:n.hasMoved)&&!e[t][1].piece&&!e[t][2].piece&&!e[t][3].piece):!e[i][l].piece||(null===(r=e[i][l].piece)||void 0===r?void 0:r.color)!==d.color},eb=(e,t)=>{let o=0;e.capturedPiece&&(o+=10*q[e.capturedPiece.type]),"pawn"===e.piece.type&&(0===e.toRow||7===e.toRow)&&(o+=5*q.queen);let i=t.map(e=>e.map(e=>({...e,piece:e.piece?{...e.piece}:null})));return i[e.toRow][e.toCol].piece=e.piece,i[e.fromRow][e.fromCol].piece=null,ed(i,"white"===e.piece.color?"black":"white")&&(o+=5),("pawn"===e.piece.type||"knight"===e.piece.type)&&(o+=(4-(Math.abs(e.toRow-3.5)+Math.abs(e.toCol-3.5)))/2),"king"!==e.piece.type||e.piece.hasMoved||2===Math.abs(e.fromCol-e.toCol)||(o-=3),o},ex=()=>{if(p||"black"!==a||S)return;k(!0);let o=eu(e,"black");if(0===o.length){k(!1);return}let i=o.map(t=>({...t,score:eb(t,e)}));i.sort((e,t)=>t.score-e.score);let l=i.slice(0,Math.min(3,i.length)),r=l[Math.floor(Math.random()*l.length)];if("pawn"===r.piece.type&&7===r.toRow){let o=[...e.map(e=>[...e])],i=o[r.fromRow][r.fromCol].piece,l=o[r.toRow][r.toCol].piece;if(i){_(null);let e=!1;1!==Math.abs(r.fromCol-r.toCol)||o[r.toRow][r.toCol].piece||(e=!0,o[r.fromRow][r.toCol].piece=null),o[r.toRow][r.toCol].piece={...i,type:"queen",hasMoved:!0},o[r.fromRow][r.fromCol].piece=null;let c=ed(o,"white"),a=c&&!eh(o,"white"),n=ec(r.fromRow,r.fromCol,r.toRow,r.toCol,i,l,c,a,!1,e,"queen"),d={from:{row:r.fromRow,col:r.fromCol},to:{row:r.toRow,col:r.toCol},piece:{...i},capturedPiece:l?{...l}:null,notation:n,isCheck:c,isCheckmate:a,promotedTo:"queen",isEnPassant:e},p=[...j.slice(0,M+1),d];N(p),R(p.length-1),t(o),s("white"),ey(o,"white")}}else ea(r.fromRow,r.fromCol,r.toRow,r.toCol);k(!1)},ey=(e,t)=>{if(ed(e,t)){if(eh(e,t))d("".concat("white"===t?"Brancas":"Pretas"," em xeque!"));else{d("Xeque-mate! ".concat("white"===t?"Pretas":"Brancas"," venceram!")),w(!0);return}}else{if(!eh(e,t)){d("Empate por afogamento!"),w(!0);return}d("")}},ek=()=>{D([]),Y(null),J(null)},ej=e=>String.fromCharCode(97+e),eN=e=>8-e,eM=(e,t)=>{let o=Array(8).fill(null).map((e,t)=>Array(8).fill(null).map((e,o)=>({piece:null,highlighted:!1,selected:!1,isValidMove:!1,position:{row:t,col:o}})));for(let e=0;e<8;e++)o[1][e].piece={type:"pawn",color:"black",hasMoved:!1},o[6][e].piece={type:"pawn",color:"white",hasMoved:!1};o[0][0].piece={type:"rook",color:"black",hasMoved:!1},o[0][7].piece={type:"rook",color:"black",hasMoved:!1},o[7][0].piece={type:"rook",color:"white",hasMoved:!1},o[7][7].piece={type:"rook",color:"white",hasMoved:!1},o[0][1].piece={type:"knight",color:"black"},o[0][6].piece={type:"knight",color:"black"},o[7][1].piece={type:"knight",color:"white"},o[7][6].piece={type:"knight",color:"white"},o[0][2].piece={type:"bishop",color:"black"},o[0][5].piece={type:"bishop",color:"black"},o[7][2].piece={type:"bishop",color:"white"},o[7][5].piece={type:"bishop",color:"white"},o[0][3].piece={type:"queen",color:"black"},o[7][3].piece={type:"queen",color:"white"},o[0][4].piece={type:"king",color:"black",hasMoved:!1},o[7][4].piece={type:"king",color:"white",hasMoved:!1};for(let i=0;i<=t;i++){let t=e[i];t.promotedTo?o[t.to.row][t.to.col].piece={...t.piece,type:t.promotedTo,hasMoved:!0}:o[t.to.row][t.to.col].piece={...t.piece,hasMoved:!0},o[t.from.row][t.from.col].piece=null,t.isEnPassant&&(o[t.from.row][t.to.col].piece=null),t.isCastling&&(6===t.to.col?(o[t.from.row][5].piece=o[t.from.row][7].piece,o[t.from.row][7].piece=null,o[t.from.row][5].piece&&(o[t.from.row][5].piece.hasMoved=!0)):2===t.to.col&&(o[t.from.row][3].piece=o[t.from.row][0].piece,o[t.from.row][0].piece=null,o[t.from.row][3].piece&&(o[t.from.row][3].piece.hasMoved=!0)))}return o},eC=e=>{if(!(e<-1)&&!(e>=j.length)){if(-1===e){U(),A(!0),R(-1);return}t(eM(j,e)),R(e),A(!0),s((e+1)%2==0?"white":"black")}},eR=()=>{S&&(0===j.length?U():(t(eM(j,j.length-1)),R(j.length-1),s(j.length%2==0?"white":"black")),A(!1))};return(0,i.jsxs)("div",{className:"flex flex-col md:flex-row items-start justify-center gap-6",children:[(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between w-full max-w-md mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(C,{id:"bot-mode",checked:b,onCheckedChange:()=>{S&&(A(!1),t(eM(j,j.length-1)),R(j.length-1)),x(!b),b||"black"!==a||setTimeout(()=>ex(),100)},disabled:p}),(0,i.jsx)(V,{htmlFor:"bot-mode",className:"text-white flex items-center",children:b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{className:"w-4 h-4 mr-1"})," Modo Single Player"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.A,{className:"w-4 h-4 mr-1"})," Modo Dois Jogadores"]})})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)(h,{onClick:ek,variant:"outline",className:"bg-[#5882d8] hover:bg-[#4872c8] text-white",title:"Limpar setas",children:[(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:[(0,i.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,i.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),"Setas"]}),(0,i.jsxs)(h,{onClick:()=>{U(),ek()},variant:"outline",className:"bg-[#7fa650] hover:bg-[#8fb760] text-white",children:[(0,i.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Reiniciar"]})]})]}),n&&(0,i.jsx)("div",{className:"mb-4 text-xl font-bold ".concat(n.includes("Xeque-mate")?"text-red-500":"text-white"),children:n}),(0,i.jsx)("div",{className:"mb-4 text-white",children:S?(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"mr-2",children:"Visualizando hist\xf3rico"}),(0,i.jsx)(h,{onClick:eR,variant:"outline",size:"sm",className:"ml-2",children:"Voltar ao jogo"})]}):y?(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"mr-2",children:"Bot pensando..."}),(0,i.jsx)("div",{className:"w-4 h-4 rounded-full bg-[#7fa650] animate-pulse"})]}):(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"mr-2",children:"Vez das"}),(0,i.jsx)("div",{className:"w-4 h-4 rounded-full ".concat("white"===a?"bg-white":"bg-black"," mr-2")}),(0,i.jsx)("span",{children:"white"===a?"Brancas":"Pretas"})]})}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"absolute top-0 left-0 right-0 flex",children:Array(8).fill(0).map((e,t)=>(0,i.jsx)("div",{className:"w-12 h-6 sm:w-16 sm:h-6 flex items-center justify-center text-xs text-gray-400",children:ej(t)},"top-".concat(t)))}),(0,i.jsx)("div",{className:"absolute top-6 bottom-0 left-0 flex flex-col",children:Array(8).fill(0).map((e,t)=>(0,i.jsx)("div",{className:"w-6 h-12 sm:w-6 sm:h-16 flex items-center justify-center text-xs text-gray-400",children:eN(t)},"left-".concat(t)))}),(0,i.jsxs)("div",{className:"relative ml-6 mt-6",onMouseLeave:()=>{F&&(W(!1),Y(null),J(null))},children:[(0,i.jsx)("div",{className:"grid grid-cols-8 border-2 border-[#333333] shadow-lg",children:e.map((e,t)=>e.map((e,o)=>(0,i.jsx)("div",{className:"\n                      w-12 h-12 sm:w-16 sm:h-16 flex items-center justify-center\n                      ".concat((t+o)%2==0?"bg-[#f0d9b5]":"bg-[#b58863]"," \n                      ").concat(e.selected?"ring-4 ring-[#5882d8] ring-inset":"","\n                      ").concat(e.highlighted&&!e.piece?"bg-[#5882d8] bg-opacity-50":"","\n                      ").concat(e.highlighted&&e.piece?"bg-[#d85858] bg-opacity-50":"","\n                      relative\n                      ").concat(b&&"black"===a&&!p||S?"cursor-not-allowed":"cursor-pointer","\n                      ").concat(F&&X&&X.row===t&&X.col===o?"ring-2 ring-yellow-500 ring-inset":"","\n                    "),onClick:()=>Q(t,o),onContextMenu:e=>e.preventDefault(),onMouseDown:e=>I(e,t,o),onMouseMove:e=>K(e,t,o),onMouseUp:e=>Z(e,t,o),children:e.piece&&(0,i.jsx)(r,{type:e.piece.type,color:e.piece.color})},"".concat(t,"-").concat(o))))}),(0,i.jsx)("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",viewBox:"0 0 ".concat(384," ").concat(384),style:{width:"100%",height:"100%"},children:T.map((e,t)=>{let o=48*e.from.col+24,l=48*e.from.row+24,r=48*e.to.col+24,c=48*e.to.row+24,a=Math.atan2(c-l,r-o),s=r-10*Math.cos(a),n=c-10*Math.sin(a);if(!e.isLShaped)return(0,i.jsxs)("g",{children:[(0,i.jsx)("defs",{children:(0,i.jsx)("marker",{id:"arrowhead-".concat(t),markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:(0,i.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:e.color})})}),(0,i.jsx)("line",{x1:o,y1:l,x2:s,y2:n,stroke:e.color,strokeWidth:"3",markerEnd:"url(#arrowhead-".concat(t,")"),opacity:"0.7"})]},t);{let a=Math.atan2(c-c,r-o),s=r-10*Math.cos(a),n=c-10*Math.sin(a);return(0,i.jsxs)("g",{children:[(0,i.jsx)("defs",{children:(0,i.jsx)("marker",{id:"arrowhead-".concat(t),markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:(0,i.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:e.color})})}),(0,i.jsx)("polyline",{points:"".concat(o,",").concat(l," ").concat(o,",").concat(c," ").concat(s,",").concat(n),stroke:e.color,strokeWidth:"3",fill:"none",markerEnd:"url(#arrowhead-".concat(t,")"),opacity:"0.7"})]},t)}})})]}),(0,i.jsx)("div",{className:"absolute bottom-0 left-6 right-0 flex",children:Array(8).fill(0).map((e,t)=>(0,i.jsx)("div",{className:"w-12 h-6 sm:w-16 sm:h-6 flex items-center justify-center text-xs text-gray-400",children:ej(t)},"bottom-".concat(t)))}),(0,i.jsx)("div",{className:"absolute top-6 bottom-6 right-0 flex flex-col",children:Array(8).fill(0).map((e,t)=>(0,i.jsx)("div",{className:"w-6 h-12 sm:w-6 sm:h-16 flex items-center justify-center text-xs text-gray-400",children:eN(t)},"right-".concat(t)))})]}),(0,i.jsx)(E,{isOpen:z,onClose:()=>P(!1),onSelect:o=>{if(!L)return;let{fromRow:i,fromCol:l,toRow:r,toCol:c}=L,n=[...e.map(e=>[...e])],d=n[i][l].piece,p=n[r][c].piece;if(!d)return;n[r][c].piece={...d,type:o,hasMoved:!0},n[i][l].piece=null;let h="white"===a?"black":"white",u=ed(n,h),f=u&&!eh(n,h),m=ec(i,l,r,c,d,p,u,f,!1,!1,o),g={from:{row:i,col:l},to:{row:r,col:c},piece:{...d},capturedPiece:p?{...p}:null,notation:m,isCheck:u,isCheckmate:f,promotedTo:o},v=[...j.slice(0,M+1),g];N(v),R(v.length-1),s(h),t(n),P(!1),B(null),ek(),ey(n,h)},color:a})]}),(0,i.jsxs)("div",{className:"bg-[#2f2f2f] p-4 rounded-lg shadow-lg mt-4 md:mt-0 w-full md:w-64",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-white text-lg font-bold",children:"Hist\xf3rico de Movimentos"}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)(h,{onClick:()=>eC(M-1),disabled:M<=-1,size:"sm",variant:"outline",className:"p-1",children:(0,i.jsx)(g.A,{className:"h-4 w-4"})}),(0,i.jsx)(h,{onClick:()=>eC(M+1),disabled:M>=j.length-1,size:"sm",variant:"outline",className:"p-1",children:(0,i.jsx)(v.A,{className:"h-4 w-4"})})]})]}),(0,i.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===j.length?(0,i.jsx)("p",{className:"text-gray-400 text-center py-4",children:"Nenhum movimento realizado"}):(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"text-gray-400 border-b border-gray-700",children:[(0,i.jsx)("th",{className:"py-2 w-10 text-left",children:"#"}),(0,i.jsx)("th",{className:"py-2 text-left",children:"Brancas"}),(0,i.jsx)("th",{className:"py-2 text-left",children:"Pretas"})]})}),(0,i.jsx)("tbody",{children:Array.from({length:Math.ceil(j.length/2)}).map((e,t)=>{var o,l;return(0,i.jsxs)("tr",{className:"border-b border-gray-700 ".concat(M===2*t||M===2*t+1?"bg-[#444444]":"hover:bg-[#3a3a3a]"),children:[(0,i.jsxs)("td",{className:"py-2 text-gray-400",children:[t+1,"."]}),(0,i.jsx)("td",{className:"py-2 cursor-pointer ".concat(M===2*t?"text-white font-bold":"text-gray-300"),onClick:()=>eC(2*t),children:null===(o=j[2*t])||void 0===o?void 0:o.notation}),(0,i.jsx)("td",{className:"py-2 cursor-pointer ".concat(M===2*t+1?"text-white font-bold":"text-gray-300"),onClick:()=>eC(2*t+1),children:(null===(l=j[2*t+1])||void 0===l?void 0:l.notation)||""})]},t)})})]})}),S&&(0,i.jsx)(h,{onClick:eR,className:"w-full mt-4 bg-[#7fa650] hover:bg-[#8fb760] text-white",children:"Voltar ao jogo atual"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[271,441,517,358],()=>t(8285)),_N_E=e.O()}]);